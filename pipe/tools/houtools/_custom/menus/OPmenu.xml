<?xml version="1.0" encoding="UTF-8"?>

<!-- menuDocument can only contain 1 menu whose id is implicitly "root_menu" -->
<menuDocument>
	<menu>
		<!-- ============================ Start Tool Cloner Tool =========================== -->
		<scriptItem id="opmenu.checkoutTool">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Clone Tool</label>
			<expression>
from pipe.am.project import Project
node = kwargs.get('node', None)
if node:
	if node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.find('_main')
			node_name = node_name[:index]
			if node_name in Project().list_tools():
				return 1
				print("This is the Cloner Tool MenuItem")
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.cloner import cloner
node = kwargs.get('node', None)
if node:
	cloner = Cloner()
	cloner.clone_tool(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Tool Cloner Tool =========================== -->

		<!-- ============================ Start Tool Publisher Tool =========================== -->
		<scriptItem id="opmenu.publishTool">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Publish Tool</label>
			<expression>
from pipe.am.project import Project
node = kwargs.get('node', None)
if node:
	if not node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.find('_main')
			node_name = node_name[:index]
			if node_name in Project().list_tools():
				return 1
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.publisher import publisher
node = kwargs.get('node', None)
if node:
	publisher = Publisher()
	publish.publish_tool(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Tool Publisher Tool =========================== -->

		<!-- ============================ Start Tool Rollback Tool =========================== -->
		<scriptItem id="opmenu.rollbackTool">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Rollback Tool</label>
			<expression>
from pipe.am.project import Project
node = kwargs.get('node', None)
if node:
	if node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.find('_main')
			node_name = node_name[:index]
			if node_name in Project().list_tools():
				return 1
				print "This is the Rollback Tool MenuItem"
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.rollback import rollback
node = kwargs.get('node', None)
if node:
	rollback = Rollback()
	rollback.rollback_tool(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Tool Rollback Tool =========================== -->

		<!-- ============================ Start Asset Cloner Tool =========================== -->
		<scriptItem id="opmenu.checkoutAsset">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Clone Asset</label>
			<expression>
from pipe.am.project import Project
node = kwargs.get('node', None)
if node:
	if node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.rfind('_')
			node_name = node_name[:index]
			node_body = Project().get_body(node_name)
			if node_body:
				if node_body.is_asset():
					return 1
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.cloner import cloner
node = kwargs.get('node', None)
if node:
	cloner = Cloner()
	cloner.clone_asset(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Asset Cloner Tool =========================== -->

		<!-- ============================ Start Asset Publisher Tool =========================== -->
		<scriptItem id="opmenu.publishAsset">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Publish Asset</label>
			<expression>
from pipe.am.project import Project
from pipe.am.body import Body
node = kwargs.get('node', None)
if node:
	if not node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.rfind('_')
			node_name = node_name[:index]
			node_body = Project().get_body(node_name)
			if node_body:
				if node_body.is_asset():
					return 1
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.publisher import publisher
node = kwargs.get('node', None)
if node:
	publisher = Publisher()
	publish.publish_asset(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Asset Publisher Tool =========================== -->

		<!-- ============================ Start Asset Rollback Tool =========================== -->
		<scriptItem id="opmenu.rollbackAsset">
			<insertBefore>opmenu.create_hda</insertBefore>
			<label>Rollback Asset</label>
			<expression>
from pipe.am.project import Project
node = kwargs.get('node', None)
if node:
	if node.isLockedHDA():
		if node.type().definition() is not None:
			node_name = node.type().name()
			index = node_name.rfind('_')
			node_name = node_name[:index]
			node_body = Project().get_body(node_name)
			if node_body:
				if node_body.is_asset():
					return 1
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.rollback import rollback
node = kwargs.get('node', None)
if node:
	rollback = Rollback()
	rollback.rollback_asset(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Asset Rollback Tool =========================== -->

		<!-- ============================ Start Tool Creator Tool =========================== -->
		<scriptItem id="opmenu.createTool">
			<label>Create DCC Digital Asset</label>
			<insertBefore>opmenu.create_hda</insertBefore>
			<expression>
node = kwargs.get('node', None)
if node:
	return node.canCreateDigitalAsset()
return 0
			</expression>
			<scriptCode scriptType="python">
				<![CDATA[
from pipe.tools.houtools.utils import create_tool_hda
node = kwargs.get('node', None)
if node:
	create_tool_hda = CreateToolHda()
	create_tool_hda.go(node)
				]]>
			</scriptCode>
		</scriptItem>
		<!-- ============================ End Tool Creator Tool =========================== -->

	</menu>
</menuDocument>
